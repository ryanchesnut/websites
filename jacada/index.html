<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>
    <header class="w3-container w3-red">
        <h1>Customer Information</h1>
    </header>

    <ul id="customers" class="w3-ul w3-border">
    </ul>

    <footer></footer>
    
    <script>
    let data = '';
        (function () {
            $.ajax({
                url: 'js/customerData.json',
                dataType: 'json',
                success: function (data) {
                    let JSONdata = JSON.stringify(data);
                    for (var i = 0; i < data.customers.length; i++) {
                        let pic = data.customers[i].profilePicture;
                        let name = data.customers[i].name;
                        let email = data.customers[i].email;
                        let phoneNumber = data.customers[i].phoneNumber;
                        let company = data.customers[i].company;
                        let html = '<li id="customer-' + i
                            + '"><div class="customer-container"><div class="profile-pic"><img src=img/'
                            + pic +
                            ' class="w3-card-4" height="70px" ></div> &nbsp;<div class="customer-name">'
                            + name +
                            ''
                            + '<button class="w3-button w3-blue" id=button-' + i
                            + '> About Me </button></div>' +
                            '</div></li>';
                        $('#customers').append($(html));
                        html = '<div id=info-' + i +
                            ' style="display:none"><ul><li>' +
                            'Phone: ' + phoneNumber +
                            '</li><li>Email: ' + email +
                            '</li><li>Company: ' + company +
                            '</li></ul></div>';
                        $('#customer-' + i).append($(html));
                    }
                }
            });
        })();

        let clicked = [];

        $(document).ready(function () {
            $('[id^="button-"]').click(function (event) {
                let selectedIdNumber = event.target.id[event.target.id.length - 1];
                if (clicked[selectedIdNumber] || clicked[selectedIdNumber] == undefined) {
                    $('#info-' + selectedIdNumber).css("display", "block");
                    clicked[selectedIdNumber] = false;
                }
                else {
                    $('#info-' + selectedIdNumber).css("display", "none");
                    clicked[selectedIdNumber] = true;
                }
            })
        });
    </script>
</body>

</html>